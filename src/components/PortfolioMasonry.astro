---
// PortfolioMasonry.astro - A masonry grid portfolio component with smooth hover effects
import "@styles/portfolio.less";
import { getCollection } from "astro:content";

// Get all portfolio items from the collection
const portfolioItems = await getCollection("portfolio");

// Sort by date and limit to 4 items for homepage
const sortedItems = portfolioItems
  .sort((a, b) => {
    // Sort by date (newest first)
    return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
  })
  .slice(0, 4); // Limit to 4 items for homepage

---

<section id="portfolio" class="portfolio-section">
  <div class="portfolio-container">
    <div class="portfolio-header">
      <p class="cs-topper">Our Work</p>
      <h2 class="cs-title">Featured Projects</h2>
      <div class="portfolio-divider"></div>
    </div>

    <div class="portfolio-grid homepage-grid">
      {sortedItems.map((item) => {
        // For real portfolio items, use the ID as slug
        // For placeholder items, create a slug from the title
        const slug = item.id ? 
          item.id.replace(/\.md$/, '') : 
          item.data.title.toLowerCase().replace(/\s+/g, '-');
        
        return (
          <a href={`/portfolio/${slug}`} class="portfolio-link">
            <div class={`portfolio-item ${item.data.layout || 'regular'}`}>
              <div class="portfolio-image-wrapper">
                <img src={item.data.image} alt={item.data.title} />
              </div>
              <div class="portfolio-overlay">
                <h3>{item.data.title}</h3>
                <p>{item.data.category}</p>
              </div>
            </div>
          </a>
        );
      })}
    </div>
    
    <div class="portfolio-cta">
      <a href="/portfolio" class="portfolio-button">See all projects</a>
    </div>
  </div>
</section>


